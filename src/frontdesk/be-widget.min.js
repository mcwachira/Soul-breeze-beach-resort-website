function init(e) { for (var t = 0, n = 0, i = 0; i < e.length; i++)"BookingEngineMaximumGuests" === e[i].Name && (t = parseInt(e[i].Value ? e[i].Value : 15)), "BookingEngineMaximumStay" === e[i].Name && (n = parseInt(e[i].Value ? e[i].Value : 15)); var a = new Date, o = document.getElementById("be-widget-fdm-datepicker"), s = new Pikaday({ field: o, minDate: a, onSelect: function (e) { o.value = fdmFixDateFormat(s.toString()), fdmOverrideCalendarStyles() }, onOpen: function () { fdmOverrideCalendarStyles() }, onDraw: function () { fdmOverrideCalendarStyles() } }); window.onresize = function (e) { s.hide() }, o.value = fdmFixDateFormat(a.toString()); for (var r = document.getElementById("be-widget-guests-number"), i = 0; i < t; i++)(l = document.createElement("option")).value = i + 1, l.innerHTML = i + 1, r.appendChild(l); for (var d = document.getElementById("be-widget-nights-number"), i = 0; i < n; i++) { var l = document.createElement("option"); l.value = i + 1, l.innerHTML = i + 1, d.appendChild(l) } } function fdmReadCustomSettings() { _beFdmMainColor = document.getElementById("be-widget-mainColor").value, _beFdmGradientColor = document.getElementById("be-widget-gradientColor").value, _beFdmBorderStyle = document.getElementById("be-widget-borderStyle").value, _hostelId = document.getElementById("be-widget-hostelId").value, _beHost = document.getElementById("be-widget-host").value } function fdmOverrideCalendarStyles() { var e = document.getElementsByClassName("pika-prev"), t = document.getElementsByClassName("pika-next"), n = document.getElementsByClassName("pika-label"), i = document.getElementsByTagName("abbr"), a = document.getElementsByClassName("is-selected"), o = document.getElementsByClassName("is-today"); if (e) for (s = 0; s < e.length; s++)e[s].style.color = _beFdmMainColor; if (t) for (s = 0; s < t.length; s++)t[s].style.color = _beFdmMainColor; if (n) for (s = 0; s < n.length; s++)n[s].style.color = _beFdmMainColor; if (i) for (s = 0; s < i.length; s++)i[s].style.color = _beFdmMainColor; if (a) for (s = 0; s < a.length; s++)a[s].children[0].style.backgroundColor = _beFdmMainColor; if (o) for (var s = 0; s < o.length; s++)o[s].children[0].style.borderColor = _beFdmMainColor } function fdmAddListeners() { var e = document.getElementById("be-widget-fdm-submit-button"); e.addEventListener("click", fdmGoToBE), e.addEventListener("mouseover", fdmMouseoverSubmitButton), e.addEventListener("mouseout", fdmMouseoutSubmitButton) } function fdmFixDateFormat(e) { for (var t = e.split(" "), n = t[1].trim(), i = t[2].trim(), a = t[3].trim(), o = 0; o < 12; o++)m[o] == n && (n = o + 1 < 10 ? "0" + (o + 1) : o + 1); return a + "-" + n + "-" + i } function fdmGoToBE() { var e = document.getElementById("be-widget-fdm-datepicker").value, t = document.getElementById("be-widget-nights-number").value, n = document.getElementById("be-widget-guests-number").value, i = (document.getElementById("be-widget-hostelId").value, _beHost + "?hostelId=" + _hostelId + "&nights=" + t + "&guests=" + n + "&arrival=" + e); window.location = i } function fdmMouseoverSubmitButton(e) { e.currentTarget.style.backgroundImage = "-webkit-gradient(linear, left top, left bottom, from(" + _beFdmGradientColor + "), to(" + _beFdmMainColor + "))" } function fdmMouseoutSubmitButton(e) { e.currentTarget.style.backgroundImage = "-webkit-gradient(linear, left top, left bottom, from(" + _beFdmMainColor + "), to(" + _beFdmGradientColor + "))" } function getBeSettings(e) { var t = _beHost + "/Widget/GetHostelSettings?hostelId=" + _hostelId + "&callback=OnComplete"; tempscript = document.createElement("script"), tempscript.type = "text/javascript", tempscript.id = "tempscript", tempscript.src = t, document.body.appendChild(tempscript) } function OnComplete(e) { init(JSON.parse(e)) } function loadPikaday() { var e = _beHost + "/App_Scripts/Widget/pikaday.js"; tempscript = document.createElement("script"), tempscript.type = "text/javascript", tempscript.id = "tempscript", tempscript.src = e, document.body.appendChild(tempscript) } !function (e, t) { "use strict"; var n; if ("object" == typeof exports) { try { n = require("moment") } catch (e) { } module.exports = t(n) } else "function" == typeof define && define.amd ? define(function (e) { try { n = e("moment") } catch (e) { } return t(n) }) : e.Pikaday = t(e.moment) }(this, function (e) { "use strict"; var t = "function" == typeof e, n = !!window.addEventListener, i = window.document, a = window.setTimeout, o = function (e, t, i, a) { n ? e.addEventListener(t, i, !!a) : e.attachEvent("on" + t, i) }, s = function (e, t, i, a) { n ? e.removeEventListener(t, i, !!a) : e.detachEvent("on" + t, i) }, r = function (e, t, n) { var a; i.createEvent ? ((a = i.createEvent("HTMLEvents")).initEvent(t, !0, !1), a = v(a, n), e.dispatchEvent(a)) : i.createEventObject && (a = i.createEventObject(), a = v(a, n), e.fireEvent("on" + t, a)) }, d = function (e) { return e.trim ? e.trim() : e.replace(/^\s+|\s+$/g, "") }, l = function (e, t) { return -1 !== (" " + e.className + " ").indexOf(" " + t + " ") }, u = function (e, t) { l(e, t) || (e.className = "" === e.className ? t : e.className + " " + t) }, h = function (e, t) { e.className = d((" " + e.className + " ").replace(" " + t + " ", " ")) }, c = function (e) { return /Array/.test(Object.prototype.toString.call(e)) }, m = function (e) { return /Date/.test(Object.prototype.toString.call(e)) && !isNaN(e.getTime()) }, f = function (e) { var t = e.getDay(); return 0 === t || 6 === t }, g = function (e) { return e % 4 == 0 && e % 100 != 0 || e % 400 == 0 }, p = function (e, t) { return [31, g(e) ? 29 : 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31][t] }, y = function (e) { m(e) && e.setHours(0, 0, 0, 0) }, b = function (e, t) { return e.getTime() === t.getTime() }, v = function (e, t, n) { var i, a; for (i in t) a = void 0 !== e[i], a && "object" == typeof t[i] && null !== t[i] && void 0 === t[i].nodeName ? m(t[i]) ? n && (e[i] = new Date(t[i].getTime())) : c(t[i]) ? n && (e[i] = t[i].slice(0)) : e[i] = v({}, t[i], n) : !n && a || (e[i] = t[i]); return e }, _ = function (e) { return e.month < 0 && (e.year -= Math.ceil(Math.abs(e.month) / 12), e.month += 12), e.month > 11 && (e.year += Math.floor(Math.abs(e.month) / 12), e.month -= 12), e }, D = { field: null, bound: void 0, position: "bottom left", reposition: !0, format: "YYYY-MM-DD", defaultDate: null, setDefaultDate: !1, firstDay: 0, minDate: null, maxDate: null, yearRange: 10, showWeekNumber: !1, minYear: 0, maxYear: 9999, minMonth: void 0, maxMonth: void 0, startRange: null, endRange: null, isRTL: !1, yearSuffix: "", showMonthAfterYear: !1, numberOfMonths: 1, mainCalendar: "left", container: void 0, i18n: { previousMonth: "Previous Month", nextMonth: "Next Month", months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"], weekdays: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"], weekdaysShort: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"] }, theme: null, onSelect: null, onOpen: null, onClose: null, onDraw: null }, w = function (e, t, n) { for (t += e.firstDay; t >= 7;)t -= 7; return n ? e.i18n.weekdaysShort[t] : e.i18n.weekdays[t] }, M = function (e) { if (e.isEmpty) return '<td class="is-empty"></td>'; var t = []; return e.isDisabled && t.push("is-disabled"), e.isToday && t.push("is-today"), e.isSelected && t.push("is-selected"), e.isInRange && t.push("is-inrange"), e.isStartRange && t.push("is-startrange"), e.isEndRange && t.push("is-endrange"), '<td data-day="' + e.day + '" class="' + t.join(" ") + '"><button class="pika-button pika-day" type="button" data-pika-year="' + e.year + '" data-pika-month="' + e.month + '" data-pika-day="' + e.day + '">' + e.day + "</button></td>" }, k = function (e, t, n) { var i = new Date(n, 0, 1); return '<td class="pika-week">' + Math.ceil(((new Date(n, t, e) - i) / 864e5 + i.getDay() + 1) / 7) + "</td>" }, C = function (e, t) { return "<tr>" + (t ? e.reverse() : e).join("") + "</tr>" }, E = function (e) { return "<tbody>" + e.join("") + "</tbody>" }, x = function (e) { var t, n = []; for (e.showWeekNumber && n.push("<th></th>"), t = 0; t < 7; t++)n.push('<th scope="col"><abbr title="' + w(e, t) + '">' + w(e, t, !0) + "</abbr></th>"); return "<thead>" + (e.isRTL ? n.reverse() : n).join("") + "</thead>" }, R = function (e, t, n, i, a) { var o, s, r, d, l, u = e._o, h = n === u.minYear, m = n === u.maxYear, f = '<div class="pika-title">', g = !0, p = !0; for (r = [], o = 0; o < 12; o++)r.push('<option value="' + (n === a ? o - t : 12 + o - t) + '"' + (o === i ? " selected" : "") + (h && o < u.minMonth || m && o > u.maxMonth ? "disabled" : "") + ">" + u.i18n.months[o] + "</option>"); for (d = '<div class="pika-label">' + u.i18n.months[i] + '<select class="pika-select pika-select-month" tabindex="-1">' + r.join("") + "</select></div>", c(u.yearRange) ? (o = u.yearRange[0], s = u.yearRange[1] + 1) : (o = n - u.yearRange, s = 1 + n + u.yearRange), r = []; o < s && o <= u.maxYear; o++)o >= u.minYear && r.push('<option value="' + o + '"' + (o === n ? " selected" : "") + ">" + o + "</option>"); return l = '<div class="pika-label">' + n + u.yearSuffix + '<select class="pika-select pika-select-year" tabindex="-1">' + r.join("") + "</select></div>", f += u.showMonthAfterYear ? l + d : d + l, h && (0 === i || u.minMonth >= i) && (g = !1), m && (11 === i || u.maxMonth <= i) && (p = !1), 0 === t && (f += '<button class="pika-prev' + (g ? "" : " is-disabled") + '" type="button">' + u.i18n.previousMonth + "</button>"), t === e._o.numberOfMonths - 1 && (f += '<button class="pika-next' + (p ? "" : " is-disabled") + '" type="button">' + u.i18n.nextMonth + "</button>"), f += "</div>" }, S = function (e, t) { return '<table cellpadding="0" cellspacing="0" class="pika-table">' + x(e) + E(t) + "</table>" }, I = function (s) { var r = this, d = r.config(s); r._onMouseDown = function (e) { if (r._v) { var t = (e = e || window.event).target || e.srcElement; if (t) if (l(t, "is-disabled") || (l(t, "pika-button") && !l(t, "is-empty") ? (r.setDate(new Date(t.getAttribute("data-pika-year"), t.getAttribute("data-pika-month"), t.getAttribute("data-pika-day"))), d.bound && a(function () { r.hide(), d.field && d.field.blur() }, 100)) : l(t, "pika-prev") ? r.prevMonth() : l(t, "pika-next") && r.nextMonth()), l(t, "pika-select")) r._c = !0; else { if (!e.preventDefault) return e.returnValue = !1, !1; e.preventDefault() } } }, r._onChange = function (e) { var t = (e = e || window.event).target || e.srcElement; t && (l(t, "pika-select-month") ? r.gotoMonth(t.value) : l(t, "pika-select-year") && r.gotoYear(t.value)) }, r._onInputChange = function (n) { var i; n.firedBy !== r && (t ? (i = e(d.field.value, d.format), i = i && i.isValid() ? i.toDate() : null) : i = new Date(Date.parse(d.field.value)), m(i) && r.setDate(i), r._v || r.show()) }, r._onInputFocus = function () { r.show() }, r._onInputClick = function () { r.show() }, r._onInputBlur = function () { var e = i.activeElement; do { if (l(e, "pika-single")) return } while (e = e.parentNode); r._c || (r._b = a(function () { r.hide() }, 50)), r._c = !1 }, r._onClick = function (e) { var t = (e = e || window.event).target || e.srcElement, i = t; if (t) { !n && l(t, "pika-select") && (t.onchange || (t.setAttribute("onchange", "return;"), o(t, "change", r._onChange))); do { if (l(i, "pika-single") || i === d.trigger) return } while (i = i.parentNode); r._v && t !== d.trigger && i !== d.trigger && r.hide() } }, r.el = i.createElement("div"), r.el.className = "pika-single" + (d.isRTL ? " is-rtl" : "") + (d.theme ? " " + d.theme : ""), o(r.el, "mousedown", r._onMouseDown, !0), o(r.el, "touchend", r._onMouseDown, !0), o(r.el, "change", r._onChange), d.field && (d.container ? d.container.appendChild(r.el) : d.bound ? i.body.appendChild(r.el) : d.field.parentNode.insertBefore(r.el, d.field.nextSibling), o(d.field, "change", r._onInputChange), d.defaultDate || (t && d.field.value ? d.defaultDate = e(d.field.value, d.format).toDate() : d.defaultDate = new Date(Date.parse(d.field.value)), d.setDefaultDate = !0)); var u = d.defaultDate; m(u) ? d.setDefaultDate ? r.setDate(u, !0) : r.gotoDate(u) : r.gotoDate(new Date), d.bound ? (this.hide(), r.el.className += " is-bound", o(d.trigger, "click", r._onInputClick), o(d.trigger, "focus", r._onInputFocus), o(d.trigger, "blur", r._onInputBlur)) : this.show() }; return I.prototype = { config: function (e) { this._o || (this._o = v({}, D, !0)); var t = v(this._o, e, !0); t.isRTL = !!t.isRTL, t.field = t.field && t.field.nodeName ? t.field : null, t.theme = "string" == typeof t.theme && t.theme ? t.theme : null, t.bound = !!(void 0 !== t.bound ? t.field && t.bound : t.field), t.trigger = t.trigger && t.trigger.nodeName ? t.trigger : t.field, t.disableWeekends = !!t.disableWeekends, t.disableDayFn = "function" == typeof t.disableDayFn ? t.disableDayFn : null; var n = parseInt(t.numberOfMonths, 10) || 1; if (t.numberOfMonths = n > 4 ? 4 : n, m(t.minDate) || (t.minDate = !1), m(t.maxDate) || (t.maxDate = !1), t.minDate && t.maxDate && t.maxDate < t.minDate && (t.maxDate = t.minDate = !1), t.minDate && this.setMinDate(t.minDate), t.maxDate && this.setMaxDate(t.maxDate), c(t.yearRange)) { var i = (new Date).getFullYear() - 10; t.yearRange[0] = parseInt(t.yearRange[0], 10) || i, t.yearRange[1] = parseInt(t.yearRange[1], 10) || i } else t.yearRange = Math.abs(parseInt(t.yearRange, 10)) || D.yearRange, t.yearRange > 100 && (t.yearRange = 100); return t }, toString: function (n) { return m(this._d) ? t ? e(this._d).format(n || this._o.format) : this._d.toDateString() : "" }, getMoment: function () { return t ? e(this._d) : null }, setMoment: function (n, i) { t && e.isMoment(n) && this.setDate(n.toDate(), i) }, getDate: function () { return m(this._d) ? new Date(this._d.getTime()) : null }, setDate: function (e, t) { if (!e) return this._d = null, this._o.field && (this._o.field.value = "", r(this._o.field, "change", { firedBy: this })), this.draw(); if ("string" == typeof e && (e = new Date(Date.parse(e))), m(e)) { var n = this._o.minDate, i = this._o.maxDate; m(n) && e < n ? e = n : m(i) && e > i && (e = i), this._d = new Date(e.getTime()), y(this._d), this.gotoDate(this._d), this._o.field && (this._o.field.value = this.toString(), r(this._o.field, "change", { firedBy: this })), t || "function" != typeof this._o.onSelect || this._o.onSelect.call(this, this.getDate()) } }, gotoDate: function (e) { var t = !0; if (m(e)) { if (this.calendars) { var n = new Date(this.calendars[0].year, this.calendars[0].month, 1), i = new Date(this.calendars[this.calendars.length - 1].year, this.calendars[this.calendars.length - 1].month, 1), a = e.getTime(); i.setMonth(i.getMonth() + 1), i.setDate(i.getDate() - 1), t = a < n.getTime() || i.getTime() < a } t && (this.calendars = [{ month: e.getMonth(), year: e.getFullYear() }], "right" === this._o.mainCalendar && (this.calendars[0].month += 1 - this._o.numberOfMonths)), this.adjustCalendars() } }, adjustCalendars: function () { this.calendars[0] = _(this.calendars[0]); for (var e = 1; e < this._o.numberOfMonths; e++)this.calendars[e] = _({ month: this.calendars[0].month + e, year: this.calendars[0].year }); this.draw() }, gotoToday: function () { this.gotoDate(new Date) }, gotoMonth: function (e) { isNaN(e) || (this.calendars[0].month = parseInt(e, 10), this.adjustCalendars()) }, nextMonth: function () { this.calendars[0].month++ , this.adjustCalendars() }, prevMonth: function () { this.calendars[0].month-- , this.adjustCalendars() }, gotoYear: function (e) { isNaN(e) || (this.calendars[0].year = parseInt(e, 10), this.adjustCalendars()) }, setMinDate: function (e) { y(e), this._o.minDate = e, this._o.minYear = e.getFullYear(), this._o.minMonth = e.getMonth(), this.draw() }, setMaxDate: function (e) { y(e), this._o.maxDate = e, this._o.maxYear = e.getFullYear(), this._o.maxMonth = e.getMonth(), this.draw() }, setStartRange: function (e) { this._o.startRange = e }, setEndRange: function (e) { this._o.endRange = e }, draw: function (e) { if (this._v || e) { var t = this._o, n = t.minYear, i = t.maxYear, o = t.minMonth, s = t.maxMonth, r = ""; this._y <= n && (this._y = n, !isNaN(o) && this._m < o && (this._m = o)), this._y >= i && (this._y = i, !isNaN(s) && this._m > s && (this._m = s)); for (var d = 0; d < t.numberOfMonths; d++)r += '<div class="pika-lendar">' + R(this, d, this.calendars[d].year, this.calendars[d].month, this.calendars[0].year) + this.render(this.calendars[d].year, this.calendars[d].month) + "</div>"; if (this.el.innerHTML = r, t.bound && "hidden" !== t.field.type && a(function () { t.trigger.focus() }, 1), "function" == typeof this._o.onDraw) { var l = this; a(function () { l._o.onDraw.call(l) }, 0) } } }, adjustPosition: function () { var e, t, n, a, o, s, r, d, l, u; if (!this._o.container) { if (this.el.style.position = "absolute", e = this._o.trigger, t = e, n = this.el.offsetWidth, a = this.el.offsetHeight, o = window.innerWidth || i.documentElement.clientWidth, s = window.innerHeight || i.documentElement.clientHeight, r = window.pageYOffset || i.body.scrollTop || i.documentElement.scrollTop, "function" == typeof e.getBoundingClientRect) u = e.getBoundingClientRect(), d = u.left + window.pageXOffset, l = u.bottom + window.pageYOffset; else for (d = t.offsetLeft, l = t.offsetTop + t.offsetHeight; t = t.offsetParent;)d += t.offsetLeft, l += t.offsetTop; (this._o.reposition && d + n > o || this._o.position.indexOf("right") > -1 && d - n + e.offsetWidth > 0) && (d = d - n + e.offsetWidth), (this._o.reposition && l + a > s + r || this._o.position.indexOf("top") > -1 && l - a - e.offsetHeight > 0) && (l = l - a - e.offsetHeight), this.el.style.left = d + "px", this.el.style.top = l + "px" } }, render: function (e, t) { var n = this._o, i = new Date, a = p(e, t), o = new Date(e, t, 1).getDay(), s = [], r = []; y(i), n.firstDay > 0 && (o -= n.firstDay) < 0 && (o += 7); for (var d = a + o, l = d; l > 7;)l -= 7; d += 7 - l; for (var u = 0, h = 0; u < d; u++) { var c = new Date(e, t, u - o + 1), g = !!m(this._d) && b(c, this._d), v = b(c, i), _ = u < o || u >= a + o, D = n.startRange && b(n.startRange, c), w = n.endRange && b(n.endRange, c), E = n.startRange && n.endRange && n.startRange < c && c < n.endRange, x = { day: u - o + 1, month: t, year: e, isSelected: g, isToday: v, isDisabled: n.minDate && c < n.minDate || n.maxDate && c > n.maxDate || n.disableWeekends && f(c) || n.disableDayFn && n.disableDayFn(c), isEmpty: _, isStartRange: D, isEndRange: w, isInRange: E }; r.push(M(x)), 7 == ++h && (n.showWeekNumber && r.unshift(k(u - o, t, e)), s.push(C(r, n.isRTL)), r = [], h = 0) } return S(n, s) }, isVisible: function () { return this._v }, show: function () { this._v || (h(this.el, "is-hidden"), this._v = !0, this.draw(), this._o.bound && (o(i, "click", this._onClick), this.adjustPosition()), "function" == typeof this._o.onOpen && this._o.onOpen.call(this)) }, hide: function () { var e = this._v; !1 !== e && (this._o.bound && s(i, "click", this._onClick), this.el.style.position = "static", this.el.style.left = "auto", this.el.style.top = "auto", u(this.el, "is-hidden"), this._v = !1, void 0 !== e && "function" == typeof this._o.onClose && this._o.onClose.call(this)) }, destroy: function () { this.hide(), s(this.el, "mousedown", this._onMouseDown, !0), s(this.el, "touchend", this._onMouseDown, !0), s(this.el, "change", this._onChange), this._o.field && (s(this._o.field, "change", this._onInputChange), this._o.bound && (s(this._o.trigger, "click", this._onInputClick), s(this._o.trigger, "focus", this._onInputFocus), s(this._o.trigger, "blur", this._onInputBlur))), this.el.parentNode && this.el.parentNode.removeChild(this.el) } }, I }), window.onload = function () { fdmReadCustomSettings(), loadPikaday(), fdmAddListeners(), getBeSettings() }; var m = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"], _beFdmMainColor, _beFdmGradientColor, _beFdmBorderStyle, _hostelId, _beHost;